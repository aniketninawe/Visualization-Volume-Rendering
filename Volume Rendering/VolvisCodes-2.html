<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #408080; font-style: italic">/*</span>
<span style="color: #408080; font-style: italic"> * To change this license header, choose License Headers in Project Properties.</span>
<span style="color: #408080; font-style: italic"> * To change this template file, choose Tools | Templates</span>
<span style="color: #408080; font-style: italic"> * and open the template in the editor.</span>
<span style="color: #408080; font-style: italic"> */</span>
<span style="color: #008000; font-weight: bold">package</span> <span style="color: #0000FF; font-weight: bold">volvis</span>;

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">util.VectorMath</span>;
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">volume.VoxelGradient</span>;

<span style="color: #408080; font-style: italic">/**</span>
<span style="color: #408080; font-style: italic"> *</span>
<span style="color: #408080; font-style: italic"> * @author Kartik B Bhargav, Stepan Veretennikov, Aniket Ninawe</span>
<span style="color: #408080; font-style: italic"> */</span>
<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">FunctionsImplemented</span>
{
    <span style="color: #408080; font-style: italic">// TODO 1:</span>
    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #B00040">short</span> <span style="color: #0000FF">getVoxelTrilinear</span>(<span style="color: #B00040">double</span><span style="color: #666666">[]</span> coord)
    {
        <span style="color: #408080; font-style: italic">// TODO 1: Implement Tri-Linear interpolation and use it in your code</span>
        <span style="color: #408080; font-style: italic">// instead of getVoxel().</span>
        
        <span style="color: #408080; font-style: italic">// Each of the coordinate can take values only between</span>
        <span style="color: #408080; font-style: italic">// 0 and (max_value - 1)</span>
        <span style="color: #008000; font-weight: bold">if</span> (coord<span style="color: #666666">[0]</span> <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span> <span style="color: #666666">||</span> coord<span style="color: #666666">[0]</span> <span style="color: #666666">&gt;</span> volume.<span style="color: #7D9029">getDimX</span>() <span style="color: #666666">-</span> <span style="color: #666666">1</span> <span style="color: #666666">||</span>
            coord<span style="color: #666666">[1]</span> <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span> <span style="color: #666666">||</span> coord<span style="color: #666666">[1]</span> <span style="color: #666666">&gt;</span> volume.<span style="color: #7D9029">getDimY</span>() <span style="color: #666666">-</span> <span style="color: #666666">1</span> <span style="color: #666666">||</span>
            coord<span style="color: #666666">[2]</span> <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span> <span style="color: #666666">||</span> coord<span style="color: #666666">[2]</span> <span style="color: #666666">&gt;</span> volume.<span style="color: #7D9029">getDimZ</span>() <span style="color: #666666">-</span> <span style="color: #666666">1</span>)
        {
            <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">0</span>;
        }
        
        <span style="color: #408080; font-style: italic">// Further code is implemented by referring to the following article</span>
        <span style="color: #408080; font-style: italic">// https://en.wikipedia.org/wiki/Trilinear_interpolation</span>
        
        <span style="color: #408080; font-style: italic">//Calculate x0, y0, z0 and x1, y1, z1</span>
        <span style="color: #B00040">int</span> x0 <span style="color: #666666">=</span> (<span style="color: #B00040">int</span>) Math.<span style="color: #7D9029">floor</span>(coord<span style="color: #666666">[0]</span>);
        <span style="color: #B00040">int</span> y0 <span style="color: #666666">=</span> (<span style="color: #B00040">int</span>) Math.<span style="color: #7D9029">floor</span>(coord<span style="color: #666666">[1]</span>);
        <span style="color: #B00040">int</span> z0 <span style="color: #666666">=</span> (<span style="color: #B00040">int</span>) Math.<span style="color: #7D9029">floor</span>(coord<span style="color: #666666">[2]</span>);
        
        <span style="color: #B00040">int</span> x1 <span style="color: #666666">=</span> (<span style="color: #B00040">int</span>) Math.<span style="color: #7D9029">ceil</span>(coord<span style="color: #666666">[0]</span>);
        <span style="color: #B00040">int</span> y1 <span style="color: #666666">=</span> (<span style="color: #B00040">int</span>) Math.<span style="color: #7D9029">ceil</span>(coord<span style="color: #666666">[1]</span>);
        <span style="color: #B00040">int</span> z1 <span style="color: #666666">=</span> (<span style="color: #B00040">int</span>) Math.<span style="color: #7D9029">ceil</span>(coord<span style="color: #666666">[2]</span>);
        
        <span style="color: #408080; font-style: italic">//Calculating the co-efficients : alpha, beta and gamma</span>
        <span style="color: #B00040">double</span> alpha <span style="color: #666666">=</span> (coord<span style="color: #666666">[0]</span> <span style="color: #666666">-</span> x0) <span style="color: #666666">/</span> (x1 <span style="color: #666666">-</span> x0);
        <span style="color: #B00040">double</span> beta <span style="color: #666666">=</span> (coord<span style="color: #666666">[1]</span> <span style="color: #666666">-</span> y0) <span style="color: #666666">/</span> (y1 <span style="color: #666666">-</span> y0);
        <span style="color: #B00040">double</span> gamma <span style="color: #666666">=</span> (coord<span style="color: #666666">[2]</span> <span style="color: #666666">-</span> z0) <span style="color: #666666">/</span> (z1 <span style="color: #666666">-</span> z0);
        
        <span style="color: #B00040">double</span> c000 <span style="color: #666666">=</span> volume.<span style="color: #7D9029">getVoxel</span>(x0, y0, z0); <span style="color: #408080; font-style: italic">// [0,0,0]</span>
        <span style="color: #B00040">double</span> c001 <span style="color: #666666">=</span> volume.<span style="color: #7D9029">getVoxel</span>(x0, y0, z1); <span style="color: #408080; font-style: italic">// [0,0,1]</span>
        <span style="color: #B00040">double</span> c010 <span style="color: #666666">=</span> volume.<span style="color: #7D9029">getVoxel</span>(x0, y1, z0); <span style="color: #408080; font-style: italic">// [0,1,0]</span>
        <span style="color: #B00040">double</span> c011 <span style="color: #666666">=</span> volume.<span style="color: #7D9029">getVoxel</span>(x0, y1, z1); <span style="color: #408080; font-style: italic">// [0,1,1]</span>
        <span style="color: #B00040">double</span> c100 <span style="color: #666666">=</span> volume.<span style="color: #7D9029">getVoxel</span>(x1, y0, z0); <span style="color: #408080; font-style: italic">// [1,0,0]</span>
        <span style="color: #B00040">double</span> c101 <span style="color: #666666">=</span> volume.<span style="color: #7D9029">getVoxel</span>(x1, y0, z1); <span style="color: #408080; font-style: italic">// [1,0,1]</span>
        <span style="color: #B00040">double</span> c110 <span style="color: #666666">=</span> volume.<span style="color: #7D9029">getVoxel</span>(x1, y1, z0); <span style="color: #408080; font-style: italic">// [1,1,0]</span>
        <span style="color: #B00040">double</span> c111 <span style="color: #666666">=</span> volume.<span style="color: #7D9029">getVoxel</span>(x1, y1, z1); <span style="color: #408080; font-style: italic">// [1,1,1]</span>
        
        <span style="color: #408080; font-style: italic">// Final computation of Tri-Linear Interpolation</span>
        <span style="color: #B00040">short</span> interpolated_result <span style="color: #666666">=</span> (<span style="color: #B00040">short</span>) Math.<span style="color: #7D9029">round</span>(
                (<span style="color: #666666">1</span> <span style="color: #666666">-</span> alpha) <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> beta) <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> gamma) <span style="color: #666666">*</span> c000 <span style="color: #666666">+</span>
                alpha <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> beta) <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> gamma) <span style="color: #666666">*</span> c100 <span style="color: #666666">+</span>
                (<span style="color: #666666">1</span> <span style="color: #666666">-</span> alpha) <span style="color: #666666">*</span> beta <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> gamma) <span style="color: #666666">*</span> c010 <span style="color: #666666">+</span>
                alpha <span style="color: #666666">*</span> beta <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> gamma) <span style="color: #666666">*</span> c110 <span style="color: #666666">+</span>
                (<span style="color: #666666">1</span> <span style="color: #666666">-</span> alpha) <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> beta) <span style="color: #666666">*</span> gamma <span style="color: #666666">*</span> c001 <span style="color: #666666">+</span>
                alpha <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> beta) <span style="color: #666666">*</span> gamma <span style="color: #666666">*</span> c101 <span style="color: #666666">+</span> 
                (<span style="color: #666666">1</span> <span style="color: #666666">-</span> alpha) <span style="color: #666666">*</span> beta <span style="color: #666666">*</span> gamma <span style="color: #666666">*</span> c011 <span style="color: #666666">+</span> 
                alpha <span style="color: #666666">*</span> beta <span style="color: #666666">*</span> gamma <span style="color: #666666">*</span> c111);

        <span style="color: #008000; font-weight: bold">return</span> interpolated_result;
    }
    
    <span style="color: #408080; font-style: italic">// TODO 2:</span>
    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #B00040">int</span> <span style="color: #0000FF">traceRayComposite</span>(<span style="color: #B00040">double</span><span style="color: #666666">[]</span> entryPoint, <span style="color: #B00040">double</span><span style="color: #666666">[]</span> exitPoint, <span style="color: #B00040">double</span><span style="color: #666666">[]</span> rayVector, <span style="color: #B00040">double</span> sampleStep, <span style="color: #B00040">boolean</span> frontBool)
    {
        <span style="color: #408080; font-style: italic">// the light vector is directed toward the view point (which is the source of the light)</span>
        <span style="color: #408080; font-style: italic">// another light vector would be possible</span>
        <span style="color: #B00040">double</span><span style="color: #666666">[]</span> lightVector <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #B00040">double</span><span style="color: #666666">[3]</span>;
        VectorMath.<span style="color: #7D9029">setVector</span>(lightVector, rayVector<span style="color: #666666">[0]</span>, rayVector<span style="color: #666666">[1]</span>, rayVector<span style="color: #666666">[2]</span>);

        <span style="color: #408080; font-style: italic">// creating and initializing the view vector</span>
        <span style="color: #B00040">double</span><span style="color: #666666">[]</span> viewVector <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #B00040">double</span><span style="color: #666666">[3]</span>;
        VectorMath.<span style="color: #7D9029">setVector</span>(viewVector, <span style="color: #666666">-</span>rayVector<span style="color: #666666">[0]</span>, <span style="color: #666666">-</span>rayVector<span style="color: #666666">[1]</span>, <span style="color: #666666">-</span>rayVector<span style="color: #666666">[2]</span>);

        TFColor voxelColor <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> TFColor(); <span style="color: #408080; font-style: italic">// color before Phong shading</span>
        TFColor voxelColor1 <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> TFColor(); <span style="color: #408080; font-style: italic">// color after Phong shading</span>
        TFColor currentColor <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> TFColor(); <span style="color: #408080; font-style: italic">// color from TFunc2D</span>
        TFColor colorAux <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> TFColor(); <span style="color: #408080; font-style: italic">// accumulated color</span>
        
        <span style="color: #408080; font-style: italic">// initialize colorAux</span>
        colorAux.<span style="color: #7D9029">r</span> <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>;
        colorAux.<span style="color: #7D9029">g</span> <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>;
        colorAux.<span style="color: #7D9029">b</span> <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>;
        colorAux.<span style="color: #7D9029">a</span> <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>;

        <span style="color: #408080; font-style: italic">//compute the increment and the number of samples (inverse: back-to-front)</span>
        <span style="color: #B00040">double</span><span style="color: #666666">[]</span> increments <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #B00040">double</span><span style="color: #666666">[3]</span>;
        VectorMath.<span style="color: #7D9029">setVector</span>(increments, <span style="color: #666666">-</span>rayVector<span style="color: #666666">[0]</span> <span style="color: #666666">*</span> sampleStep, <span style="color: #666666">-</span>rayVector<span style="color: #666666">[1]</span> <span style="color: #666666">*</span> sampleStep, <span style="color: #666666">-</span>rayVector<span style="color: #666666">[2]</span> <span style="color: #666666">*</span> sampleStep);

        <span style="color: #408080; font-style: italic">// Compute the number of times we need to sample</span>
        <span style="color: #B00040">double</span> distance <span style="color: #666666">=</span> VectorMath.<span style="color: #7D9029">distance</span>(entryPoint, exitPoint);
        <span style="color: #B00040">int</span> nrSamples <span style="color: #666666">=</span> <span style="color: #666666">1</span> <span style="color: #666666">+</span> (<span style="color: #B00040">int</span>) Math.<span style="color: #7D9029">floor</span>(distance <span style="color: #666666">/</span> sampleStep);

        <span style="color: #408080; font-style: italic">//the current position is initialized as the EXIT point</span>
        <span style="color: #B00040">double</span><span style="color: #666666">[]</span> currentPos <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #B00040">double</span><span style="color: #666666">[3]</span>;
        VectorMath.<span style="color: #7D9029">setVector</span>(currentPos, exitPoint<span style="color: #666666">[0]</span>, exitPoint<span style="color: #666666">[1]</span>, exitPoint<span style="color: #666666">[2]</span>);

        <span style="color: #408080; font-style: italic">// TODO 2: To be Implemented this function. Now, it just gives back a constant color depending on the mode</span>

        <span style="color: #408080; font-style: italic">// Choosing Mode, TransferFunction, TransferFunction2D based on front/back side</span>
        RaycastMode currMode <span style="color: #666666">=</span> getMode(frontBool);
        TransferFunction currTFunc <span style="color: #666666">=</span> getTFunc(frontBool);
        TransferFunction2D currTFunc2D <span style="color: #666666">=</span> getTFunc2D(frontBool);

        <span style="color: #008000; font-weight: bold">do</span>
        {
            <span style="color: #408080; font-style: italic">// get the gradient and the intensity of the voxel</span>
            <span style="color: #B00040">int</span> voxelValue <span style="color: #666666">=</span> getVoxelTrilinear(currentPos);
            VoxelGradient gradient <span style="color: #666666">=</span> getGradientTrilinear(currentPos);

            <span style="color: #408080; font-style: italic">// 1D transfer function</span>
            <span style="color: #008000; font-weight: bold">if</span> (currMode <span style="color: #666666">==</span> RaycastMode.<span style="color: #7D9029">COMPOSITING</span>)
            {
                voxelColor <span style="color: #666666">=</span> currTFunc.<span style="color: #7D9029">getColor</span>(voxelValue);
            }

            <span style="color: #008000; font-weight: bold">if</span> (currMode <span style="color: #666666">==</span> RaycastMode.<span style="color: #7D9029">TRANSFER2D</span>) 
            {
                currentColor <span style="color: #666666">=</span> currTFunc2D.<span style="color: #7D9029">color</span>;
                
                voxelColor.<span style="color: #7D9029">r</span> <span style="color: #666666">=</span> currentColor.<span style="color: #7D9029">r</span>;
                voxelColor.<span style="color: #7D9029">g</span> <span style="color: #666666">=</span> currentColor.<span style="color: #7D9029">g</span>;
                voxelColor.<span style="color: #7D9029">b</span> <span style="color: #666666">=</span> currentColor.<span style="color: #7D9029">b</span>;
                
                <span style="color: #408080; font-style: italic">// calling the compueOpacity2DTF function</span>
                voxelColor.<span style="color: #7D9029">a</span> <span style="color: #666666">=</span> currentColor.<span style="color: #7D9029">a</span> <span style="color: #666666">*</span> computeOpacity2DTF(currTFunc2D.<span style="color: #7D9029">baseIntensity</span>, 
                                                  currTFunc2D.<span style="color: #7D9029">radius</span>,
                                                  voxelValue,
                                                  gradient.<span style="color: #7D9029">mag</span>);
            }

            <span style="color: #408080; font-style: italic">// If Phong Shading enabled</span>
            <span style="color: #008000; font-weight: bold">if</span> (shadingMode)
            {
                <span style="color: #408080; font-style: italic">// Shading mode on</span>
                <span style="color: #408080; font-style: italic">//calculate the color and opacity after the application of phong shading</span>
                currentColor <span style="color: #666666">=</span> computePhongShading(voxelColor, gradient, lightVector, rayVector);

                <span style="color: #408080; font-style: italic">//assign the color to our variable voxelColor1</span>
                voxelColor1.<span style="color: #7D9029">r</span> <span style="color: #666666">=</span> currentColor.<span style="color: #7D9029">r</span>;
                voxelColor1.<span style="color: #7D9029">g</span> <span style="color: #666666">=</span> currentColor.<span style="color: #7D9029">g</span>;
                voxelColor1.<span style="color: #7D9029">b</span> <span style="color: #666666">=</span> currentColor.<span style="color: #7D9029">b</span>;
                voxelColor1.<span style="color: #7D9029">a</span> <span style="color: #666666">=</span> currentColor.<span style="color: #7D9029">a</span>;
            } <span style="color: #008000; font-weight: bold">else</span> {
                voxelColor1.<span style="color: #7D9029">r</span> <span style="color: #666666">=</span> voxelColor.<span style="color: #7D9029">r</span>;
                voxelColor1.<span style="color: #7D9029">g</span> <span style="color: #666666">=</span> voxelColor.<span style="color: #7D9029">g</span>;
                voxelColor1.<span style="color: #7D9029">b</span> <span style="color: #666666">=</span> voxelColor.<span style="color: #7D9029">b</span>;
                voxelColor1.<span style="color: #7D9029">a</span> <span style="color: #666666">=</span> voxelColor.<span style="color: #7D9029">a</span>;
            }
            
            <span style="color: #408080; font-style: italic">// compositing iteration, update accumulated color</span>
            colorAux <span style="color: #666666">=</span> compositingFromBackToFront(colorAux, voxelColor1);

            <span style="color: #008000; font-weight: bold">for</span> (<span style="color: #B00040">int</span> i <span style="color: #666666">=</span> <span style="color: #666666">0</span>; i <span style="color: #666666">&lt;</span> <span style="color: #666666">3</span>; i<span style="color: #666666">++</span>)
            {
                currentPos<span style="color: #666666">[</span>i<span style="color: #666666">]</span> <span style="color: #666666">+=</span> increments<span style="color: #666666">[</span>i<span style="color: #666666">]</span>;
            }

            nrSamples<span style="color: #666666">--</span>;
        } <span style="color: #008000; font-weight: bold">while</span> (nrSamples <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>);

        <span style="color: #408080; font-style: italic">//computes the color</span>
        <span style="color: #B00040">int</span> color <span style="color: #666666">=</span> computePackedPixelColor(colorAux.<span style="color: #7D9029">r</span>, colorAux.<span style="color: #7D9029">g</span>, 
                                            colorAux.<span style="color: #7D9029">b</span>, colorAux.<span style="color: #7D9029">a</span>);
        <span style="color: #008000; font-weight: bold">return</span> color;
    }
    
    <span style="color: #008000; font-weight: bold">private</span> TFColor <span style="color: #0000FF">compositingFromBackToFront</span>(TFColor compositedColor, TFColor currentColor)
    {
        <span style="color: #B00040">double</span> alpha <span style="color: #666666">=</span> currentColor.<span style="color: #7D9029">a</span>;
        compositedColor.<span style="color: #7D9029">r</span> <span style="color: #666666">=</span> currentColor.<span style="color: #7D9029">r</span> <span style="color: #666666">*</span> alpha <span style="color: #666666">+</span> (<span style="color: #666666">1.0</span> <span style="color: #666666">-</span> alpha) <span style="color: #666666">*</span> compositedColor.<span style="color: #7D9029">r</span>;
        compositedColor.<span style="color: #7D9029">g</span> <span style="color: #666666">=</span> currentColor.<span style="color: #7D9029">g</span> <span style="color: #666666">*</span> alpha <span style="color: #666666">+</span> (<span style="color: #666666">1.0</span> <span style="color: #666666">-</span> alpha) <span style="color: #666666">*</span> compositedColor.<span style="color: #7D9029">g</span>;
        compositedColor.<span style="color: #7D9029">b</span> <span style="color: #666666">=</span> currentColor.<span style="color: #7D9029">b</span> <span style="color: #666666">*</span> alpha <span style="color: #666666">+</span> (<span style="color: #666666">1.0</span> <span style="color: #666666">-</span> alpha) <span style="color: #666666">*</span> compositedColor.<span style="color: #7D9029">b</span>;
        compositedColor.<span style="color: #7D9029">a</span> <span style="color: #666666">=</span> alpha <span style="color: #666666">+</span> (<span style="color: #666666">1.0</span> <span style="color: #666666">-</span> alpha) <span style="color: #666666">*</span> compositedColor.<span style="color: #7D9029">a</span>;

        <span style="color: #008000; font-weight: bold">return</span> compositedColor;
   }
    
    
    <span style="color: #408080; font-style: italic">// TODO 3:</span>
    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #B00040">int</span> <span style="color: #0000FF">traceRayIso</span>(<span style="color: #B00040">double</span><span style="color: #666666">[]</span> entryPoint, <span style="color: #B00040">double</span><span style="color: #666666">[]</span> exitPoint, <span style="color: #B00040">double</span><span style="color: #666666">[]</span> rayVector, <span style="color: #B00040">double</span> sampleStep, <span style="color: #B00040">boolean</span> frontBool)
    {

        <span style="color: #B00040">double</span><span style="color: #666666">[]</span> lightVector <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #B00040">double</span><span style="color: #666666">[3]</span>;
        <span style="color: #408080; font-style: italic">//We define the light vector as directed toward the view point (which is the source of the light)</span>
        <span style="color: #408080; font-style: italic">// another light vector would be possible</span>
        
        VectorMath.<span style="color: #7D9029">setVector</span>(lightVector, rayVector<span style="color: #666666">[0]</span>, rayVector<span style="color: #666666">[1]</span>, rayVector<span style="color: #666666">[2]</span>);
        
        <span style="color: #408080; font-style: italic">// TODO 3: Implement isosurface rendering.</span>
        <span style="color: #408080; font-style: italic">//Initialization of the colors as floating point values</span>
        <span style="color: #B00040">double</span> r, g, b;
        r <span style="color: #666666">=</span> g <span style="color: #666666">=</span> b <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>;
        <span style="color: #B00040">double</span> alpha <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>;
        <span style="color: #B00040">double</span> opacity <span style="color: #666666">=</span> <span style="color: #666666">0</span>;

        <span style="color: #408080; font-style: italic">//Now we calculate the increase in samples</span>
        <span style="color: #B00040">double</span><span style="color: #666666">[]</span> increment <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #B00040">double</span><span style="color: #666666">[3]</span>;
        VectorMath.<span style="color: #7D9029">setVector</span>(increment, <span style="color: #666666">-</span> rayVector<span style="color: #666666">[0]</span> <span style="color: #666666">*</span> sampleStep, <span style="color: #666666">-</span> rayVector<span style="color: #666666">[1]</span> <span style="color: #666666">*</span> sampleStep, <span style="color: #666666">-</span> rayVector<span style="color: #666666">[2]</span> <span style="color: #666666">*</span> sampleStep);
                
        <span style="color: #408080; font-style: italic">// Compute the number of times we need to sample</span>
        <span style="color: #B00040">double</span> distance <span style="color: #666666">=</span> VectorMath.<span style="color: #7D9029">distance</span>(entryPoint, exitPoint);
        <span style="color: #B00040">int</span> nrSamples <span style="color: #666666">=</span> <span style="color: #666666">1</span> <span style="color: #666666">+</span> (<span style="color: #B00040">int</span>) Math.<span style="color: #7D9029">floor</span>(VectorMath.<span style="color: #7D9029">distance</span>(entryPoint, exitPoint) <span style="color: #666666">/</span> sampleStep);
                
        <span style="color: #408080; font-style: italic">//the current position is the exit point</span>
        <span style="color: #B00040">double</span><span style="color: #666666">[]</span> currentPos <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #B00040">double</span><span style="color: #666666">[3]</span>;
        VectorMath.<span style="color: #7D9029">setVector</span>(currentPos, exitPoint<span style="color: #666666">[0]</span>, exitPoint<span style="color: #666666">[1]</span>, exitPoint<span style="color: #666666">[2]</span>);
        
        <span style="color: #408080; font-style: italic">// Extract isoValue and color</span>
        <span style="color: #B00040">float</span> isoValue <span style="color: #666666">=</span> getIsoValue(frontBool);
        TFColor isoColor <span style="color: #666666">=</span> getIsoColor(frontBool);
        
        <span style="color: #008000; font-weight: bold">do</span> {
			<span style="color: #408080; font-style: italic">// calling tri-linear interpolation method to get the interpolated voxel</span>
            <span style="color: #B00040">int</span> value <span style="color: #666666">=</span> getVoxelTrilinear(currentPos);

            <span style="color: #008000; font-weight: bold">if</span> (value <span style="color: #666666">&gt;</span> isoValue) 
			{    
                r <span style="color: #666666">=</span> isoColor.<span style="color: #7D9029">r</span>;
                g <span style="color: #666666">=</span> isoColor.<span style="color: #7D9029">g</span>;
                b <span style="color: #666666">=</span> isoColor.<span style="color: #7D9029">b</span>;
                alpha <span style="color: #666666">=</span> isoColor.<span style="color: #7D9029">a</span>;
			
				<span style="color: #408080; font-style: italic">// check if Shading should be applied</span>
				<span style="color: #008000; font-weight: bold">if</span> (shadingMode) 
				{
					TFColor d <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> TFColor(r,g,b,alpha);
					VoxelGradient gradient <span style="color: #666666">=</span> getGradientTrilinear(currentPos);
				
					TFColor new_color <span style="color: #666666">=</span> computePhongShading(d, gradient, lightVector, rayVector);
					r <span style="color: #666666">=</span> new_color.<span style="color: #7D9029">r</span>;
					g <span style="color: #666666">=</span> new_color.<span style="color: #7D9029">g</span>;
					b <span style="color: #666666">=</span> new_color.<span style="color: #7D9029">b</span>;
					alpha <span style="color: #666666">=</span> new_color.<span style="color: #7D9029">a</span>;
				}
            }
          
            <span style="color: #008000; font-weight: bold">for</span> (<span style="color: #B00040">int</span> j <span style="color: #666666">=</span> <span style="color: #666666">0</span>; j <span style="color: #666666">&lt;</span> <span style="color: #666666">3</span>; j<span style="color: #666666">++</span>) 
			{
                currentPos<span style="color: #666666">[</span>j<span style="color: #666666">]</span> <span style="color: #666666">+=</span> increment<span style="color: #666666">[</span>j<span style="color: #666666">]</span>;
            }
           
           nrSamples<span style="color: #666666">--</span>;
        } <span style="color: #008000; font-weight: bold">while</span> (nrSamples <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>);
      
        
        <span style="color: #408080; font-style: italic">//computes the color</span>
        <span style="color: #B00040">int</span> color <span style="color: #666666">=</span> computePackedPixelColor(r, g, b, alpha);
        <span style="color: #008000; font-weight: bold">return</span> color;
    }
    
    <span style="color: #408080; font-style: italic">// TODO 4:</span>
    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">compute</span>() 
    {

        <span style="color: #008000; font-weight: bold">for</span> (<span style="color: #B00040">int</span> i<span style="color: #666666">=0</span>; i<span style="color: #666666">&lt;</span>data.<span style="color: #7D9029">length</span>; i<span style="color: #666666">++</span>)
        {
            data<span style="color: #666666">[</span>i<span style="color: #666666">]</span> <span style="color: #666666">=</span> zero;
        }
       
        <span style="color: #008000; font-weight: bold">for</span> (<span style="color: #B00040">int</span> z<span style="color: #666666">=1</span>; z<span style="color: #666666">&lt;</span>dimZ<span style="color: #666666">-1</span>; z<span style="color: #666666">++</span>)
        {
            <span style="color: #008000; font-weight: bold">for</span> (<span style="color: #B00040">int</span> y<span style="color: #666666">=1</span>; y<span style="color: #666666">&lt;</span>dimY<span style="color: #666666">-1</span>; y<span style="color: #666666">++</span>)
            {
                <span style="color: #008000; font-weight: bold">for</span> (<span style="color: #B00040">int</span> x<span style="color: #666666">=1</span>; x<span style="color: #666666">&lt;</span>dimX<span style="color: #666666">-1</span>; x<span style="color: #666666">++</span>)
                {
                    <span style="color: #B00040">float</span> x0 <span style="color: #666666">=</span> (volume.<span style="color: #7D9029">getVoxel</span>(x<span style="color: #666666">+1</span>, y, z) <span style="color: #666666">-</span> volume.<span style="color: #7D9029">getVoxel</span>(x<span style="color: #666666">-1</span>, y, z))<span style="color: #666666">/2.0f</span>;
                    <span style="color: #B00040">float</span> y0 <span style="color: #666666">=</span> (volume.<span style="color: #7D9029">getVoxel</span>(x, y<span style="color: #666666">+1</span>, z) <span style="color: #666666">-</span> volume.<span style="color: #7D9029">getVoxel</span>(x, y<span style="color: #666666">-1</span>, z))<span style="color: #666666">/2.0f</span>;
                    <span style="color: #B00040">float</span> z0 <span style="color: #666666">=</span> (volume.<span style="color: #7D9029">getVoxel</span>(x, y, z<span style="color: #666666">+1</span>) <span style="color: #666666">-</span> volume.<span style="color: #7D9029">getVoxel</span>(x, y, z<span style="color: #666666">-1</span>))<span style="color: #666666">/2.0f</span>;
                    VoxelGradient newvalue <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> VoxelGradient(x0, y0, z0);
                    setGradient(x, y, z, newvalue);
                }
            }
        }
     
    }
    
    <span style="color: #408080; font-style: italic">// TODO 6:</span>
    <span style="color: #008000; font-weight: bold">private</span> VoxelGradient <span style="color: #0000FF">getGradientTrilinear</span>(<span style="color: #B00040">double</span><span style="color: #666666">[]</span> coord) 
    {
        <span style="color: #408080; font-style: italic">// TODO 6: Implement Tri-linear interpolation for gradients</span>
        
        <span style="color: #408080; font-style: italic">// Get the coordinates</span>
        <span style="color: #B00040">double</span> dx <span style="color: #666666">=</span> coord<span style="color: #666666">[0]</span>, dy <span style="color: #666666">=</span> coord<span style="color: #666666">[1]</span>, dz <span style="color: #666666">=</span> coord<span style="color: #666666">[2]</span>;

        <span style="color: #408080; font-style: italic">// Verify they are inside the volume gradient</span>
        <span style="color: #008000; font-weight: bold">if</span> (dx <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span> <span style="color: #666666">||</span> dx <span style="color: #666666">&gt;</span> (gradients.<span style="color: #7D9029">getDimX</span>() <span style="color: #666666">-</span> <span style="color: #666666">2</span>) <span style="color: #666666">||</span>
            dy <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span> <span style="color: #666666">||</span> dy <span style="color: #666666">&gt;</span> (gradients.<span style="color: #7D9029">getDimY</span>() <span style="color: #666666">-</span> <span style="color: #666666">2</span>) <span style="color: #666666">||</span>
            dz <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span> <span style="color: #666666">||</span> dz <span style="color: #666666">&gt;</span> (gradients.<span style="color: #7D9029">getDimZ</span>() <span style="color: #666666">-</span> <span style="color: #666666">2</span>))
        {
            <span style="color: #408080; font-style: italic">// If not, just return a zero gradient</span>
            <span style="color: #008000; font-weight: bold">return</span> ZERO_GRADIENT;
        }
        
        <span style="color: #408080; font-style: italic">//Calculate x0, y0, z0 and x1, y1, z1</span>
        <span style="color: #B00040">int</span> x0 <span style="color: #666666">=</span> (<span style="color: #B00040">int</span>) Math.<span style="color: #7D9029">floor</span>(dx);
        <span style="color: #B00040">int</span> y0 <span style="color: #666666">=</span> (<span style="color: #B00040">int</span>) Math.<span style="color: #7D9029">floor</span>(dy);
        <span style="color: #B00040">int</span> z0 <span style="color: #666666">=</span> (<span style="color: #B00040">int</span>) Math.<span style="color: #7D9029">floor</span>(dz);
        
        <span style="color: #B00040">int</span> x1 <span style="color: #666666">=</span> (<span style="color: #B00040">int</span>) Math.<span style="color: #7D9029">ceil</span>(dx);
        <span style="color: #B00040">int</span> y1 <span style="color: #666666">=</span> (<span style="color: #B00040">int</span>) Math.<span style="color: #7D9029">ceil</span>(dy);
        <span style="color: #B00040">int</span> z1 <span style="color: #666666">=</span> (<span style="color: #B00040">int</span>) Math.<span style="color: #7D9029">ceil</span>(dz);
        
        <span style="color: #408080; font-style: italic">//Calculating the co-efficients : alpha, beta and gamma</span>
        <span style="color: #B00040">float</span> alpha <span style="color: #666666">=</span> (<span style="color: #B00040">float</span>)(dx <span style="color: #666666">-</span> x0) <span style="color: #666666">/</span> (x1 <span style="color: #666666">-</span> x0);
        <span style="color: #B00040">float</span> beta <span style="color: #666666">=</span> (<span style="color: #B00040">float</span>)(dy <span style="color: #666666">-</span> y0) <span style="color: #666666">/</span> (y1 <span style="color: #666666">-</span> y0);
        <span style="color: #B00040">float</span> gamma <span style="color: #666666">=</span> (<span style="color: #B00040">float</span>)(dz <span style="color: #666666">-</span> z0) <span style="color: #666666">/</span> (z1 <span style="color: #666666">-</span> z0);
        
        <span style="color: #408080; font-style: italic">// Computing the tri-linear interpolation of the X-component of the Gradient</span>
        <span style="color: #B00040">float</span> gradientX <span style="color: #666666">=</span> 
                (<span style="color: #666666">1</span> <span style="color: #666666">-</span> alpha) <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> beta) <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> gamma) <span style="color: #666666">*</span> gradients.<span style="color: #7D9029">getGradient</span>(x0, y0, z0).<span style="color: #7D9029">x</span> <span style="color: #666666">+</span>
                alpha <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> beta) <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> gamma) <span style="color: #666666">*</span> gradients.<span style="color: #7D9029">getGradient</span>(x1, y0, z0).<span style="color: #7D9029">x</span> <span style="color: #666666">+</span>
                (<span style="color: #666666">1</span> <span style="color: #666666">-</span> alpha) <span style="color: #666666">*</span> beta <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> gamma) <span style="color: #666666">*</span> gradients.<span style="color: #7D9029">getGradient</span>(x0, y1, z0).<span style="color: #7D9029">x</span> <span style="color: #666666">+</span>
                alpha <span style="color: #666666">*</span> beta <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> gamma) <span style="color: #666666">*</span> gradients.<span style="color: #7D9029">getGradient</span>(x1, y1, z0).<span style="color: #7D9029">x</span> <span style="color: #666666">+</span>
                (<span style="color: #666666">1</span> <span style="color: #666666">-</span> alpha) <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> beta) <span style="color: #666666">*</span> gamma <span style="color: #666666">*</span> gradients.<span style="color: #7D9029">getGradient</span>(x0, y0, z1).<span style="color: #7D9029">x</span> <span style="color: #666666">+</span>
                alpha <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> beta) <span style="color: #666666">*</span> gamma <span style="color: #666666">*</span> gradients.<span style="color: #7D9029">getGradient</span>(x1, y0, z1).<span style="color: #7D9029">x</span> <span style="color: #666666">+</span> 
                (<span style="color: #666666">1</span> <span style="color: #666666">-</span> alpha) <span style="color: #666666">*</span> beta <span style="color: #666666">*</span> gamma <span style="color: #666666">*</span> gradients.<span style="color: #7D9029">getGradient</span>(x0, y1, z1).<span style="color: #7D9029">x</span> <span style="color: #666666">+</span> 
                alpha <span style="color: #666666">*</span> beta <span style="color: #666666">*</span> gamma <span style="color: #666666">*</span> gradients.<span style="color: #7D9029">getGradient</span>(x1, y1, z1).<span style="color: #7D9029">x</span>;
        
        <span style="color: #408080; font-style: italic">// Computing the tri-linear interpolation of the Y-component of the Gradient</span>
        <span style="color: #B00040">float</span> gradientY <span style="color: #666666">=</span> 
                (<span style="color: #666666">1</span> <span style="color: #666666">-</span> alpha) <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> beta) <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> gamma) <span style="color: #666666">*</span> gradients.<span style="color: #7D9029">getGradient</span>(x0, y0, z0).<span style="color: #7D9029">y</span> <span style="color: #666666">+</span>
                alpha <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> beta) <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> gamma) <span style="color: #666666">*</span> gradients.<span style="color: #7D9029">getGradient</span>(x1, y0, z0).<span style="color: #7D9029">y</span> <span style="color: #666666">+</span>
                (<span style="color: #666666">1</span> <span style="color: #666666">-</span> alpha) <span style="color: #666666">*</span> beta <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> gamma) <span style="color: #666666">*</span> gradients.<span style="color: #7D9029">getGradient</span>(x0, y1, z0).<span style="color: #7D9029">y</span> <span style="color: #666666">+</span>
                alpha <span style="color: #666666">*</span> beta <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> gamma) <span style="color: #666666">*</span> gradients.<span style="color: #7D9029">getGradient</span>(x1, y1, z0).<span style="color: #7D9029">y</span> <span style="color: #666666">+</span>
                (<span style="color: #666666">1</span> <span style="color: #666666">-</span> alpha) <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> beta) <span style="color: #666666">*</span> gamma <span style="color: #666666">*</span> gradients.<span style="color: #7D9029">getGradient</span>(x0, y0, z1).<span style="color: #7D9029">y</span> <span style="color: #666666">+</span>
                alpha <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> beta) <span style="color: #666666">*</span> gamma <span style="color: #666666">*</span> gradients.<span style="color: #7D9029">getGradient</span>(x1, y0, z1).<span style="color: #7D9029">y</span> <span style="color: #666666">+</span> 
                (<span style="color: #666666">1</span> <span style="color: #666666">-</span> alpha) <span style="color: #666666">*</span> beta <span style="color: #666666">*</span> gamma <span style="color: #666666">*</span> gradients.<span style="color: #7D9029">getGradient</span>(x0, y1, z1).<span style="color: #7D9029">y</span> <span style="color: #666666">+</span> 
                alpha <span style="color: #666666">*</span> beta <span style="color: #666666">*</span> gamma <span style="color: #666666">*</span> gradients.<span style="color: #7D9029">getGradient</span>(x1, y1, z1).<span style="color: #7D9029">y</span>;
        
        <span style="color: #408080; font-style: italic">// Computing the tri-linear interpolation of the Z-component of the Gradient</span>
        <span style="color: #B00040">float</span> gradientZ <span style="color: #666666">=</span> 
                (<span style="color: #666666">1</span> <span style="color: #666666">-</span> alpha) <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> beta) <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> gamma) <span style="color: #666666">*</span> gradients.<span style="color: #7D9029">getGradient</span>(x0, y0, z0).<span style="color: #7D9029">z</span> <span style="color: #666666">+</span>
                alpha <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> beta) <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> gamma) <span style="color: #666666">*</span> gradients.<span style="color: #7D9029">getGradient</span>(x1, y0, z0).<span style="color: #7D9029">z</span> <span style="color: #666666">+</span>
                (<span style="color: #666666">1</span> <span style="color: #666666">-</span> alpha) <span style="color: #666666">*</span> beta <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> gamma) <span style="color: #666666">*</span> gradients.<span style="color: #7D9029">getGradient</span>(x0, y1, z0).<span style="color: #7D9029">z</span> <span style="color: #666666">+</span>
                alpha <span style="color: #666666">*</span> beta <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> gamma) <span style="color: #666666">*</span> gradients.<span style="color: #7D9029">getGradient</span>(x1, y1, z0).<span style="color: #7D9029">z</span> <span style="color: #666666">+</span>
                (<span style="color: #666666">1</span> <span style="color: #666666">-</span> alpha) <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> beta) <span style="color: #666666">*</span> gamma <span style="color: #666666">*</span> gradients.<span style="color: #7D9029">getGradient</span>(x0, y0, z1).<span style="color: #7D9029">z</span> <span style="color: #666666">+</span>
                alpha <span style="color: #666666">*</span> (<span style="color: #666666">1</span> <span style="color: #666666">-</span> beta) <span style="color: #666666">*</span> gamma <span style="color: #666666">*</span> gradients.<span style="color: #7D9029">getGradient</span>(x1, y0, z1).<span style="color: #7D9029">z</span> <span style="color: #666666">+</span> 
                (<span style="color: #666666">1</span> <span style="color: #666666">-</span> alpha) <span style="color: #666666">*</span> beta <span style="color: #666666">*</span> gamma <span style="color: #666666">*</span> gradients.<span style="color: #7D9029">getGradient</span>(x0, y1, z1).<span style="color: #7D9029">z</span> <span style="color: #666666">+</span> 
                alpha <span style="color: #666666">*</span> beta <span style="color: #666666">*</span> gamma <span style="color: #666666">*</span> gradients.<span style="color: #7D9029">getGradient</span>(x1, y1, z1).<span style="color: #7D9029">z</span>;
        
        VoxelGradient resultantGradient <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> VoxelGradient(gradientX,
                                                            gradientY,
                                                            gradientZ);
        
        <span style="color: #008000; font-weight: bold">return</span> resultantGradient;
    }
    
    <span style="color: #408080; font-style: italic">// TODO 7:</span>
    <span style="color: #008000; font-weight: bold">private</span> TFColor <span style="color: #0000FF">computePhongShading</span>(TFColor voxel_color, VoxelGradient gradient,
            <span style="color: #B00040">double</span><span style="color: #666666">[]</span> lightVector, <span style="color: #B00040">double</span><span style="color: #666666">[]</span> rayVector)
    {

        <span style="color: #408080; font-style: italic">// TODO 7: Implement Phong Shading.</span>

        <span style="color: #408080; font-style: italic">// Return the exisitng voxel color if the voxel color is zero</span>
        <span style="color: #008000; font-weight: bold">if</span>(gradient.<span style="color: #7D9029">mag</span> <span style="color: #666666">==</span> <span style="color: #666666">0</span>)
        {
            <span style="color: #008000; font-weight: bold">return</span> voxel_color;
        }

        <span style="color: #B00040">double</span> ka <span style="color: #666666">=</span> <span style="color: #666666">0.1</span>; <span style="color: #408080; font-style: italic">// ambient</span>
        <span style="color: #B00040">double</span> kd <span style="color: #666666">=</span> <span style="color: #666666">0.7</span>; <span style="color: #408080; font-style: italic">// diffuse</span>
        <span style="color: #B00040">double</span> ks <span style="color: #666666">=</span> <span style="color: #666666">0.2</span>; <span style="color: #408080; font-style: italic">// specular</span>

        <span style="color: #B00040">int</span> alpha <span style="color: #666666">=</span> <span style="color: #666666">100</span>;

        <span style="color: #B00040">double</span><span style="color: #666666">[]</span> lightProperty_a <span style="color: #666666">=</span> {<span style="color: #666666">1</span>,<span style="color: #666666">1</span>,<span style="color: #666666">1</span>};
        <span style="color: #B00040">double</span><span style="color: #666666">[]</span> lightProperty_d <span style="color: #666666">=</span> {<span style="color: #666666">1</span>,<span style="color: #666666">1</span>,<span style="color: #666666">1</span>};
        <span style="color: #B00040">double</span><span style="color: #666666">[]</span> lightProperty_s <span style="color: #666666">=</span> {<span style="color: #666666">1</span>,<span style="color: #666666">1</span>,<span style="color: #666666">1</span>};

        TFColor color;

        <span style="color: #408080; font-style: italic">// if (gradient.x == 0 &amp;&amp; gradient.y == 0 &amp;&amp; gradient.z == 0) return voxel_color;</span>
        <span style="color: #008000; font-weight: bold">if</span>(gradient.<span style="color: #7D9029">mag</span> <span style="color: #666666">==</span> <span style="color: #666666">0</span>)   <span style="color: #008000; font-weight: bold">return</span> voxel_color;

        <span style="color: #408080; font-style: italic">// norm gradiente</span>
        <span style="color: #B00040">double</span><span style="color: #666666">[]</span> gradVec <span style="color: #666666">=</span> {gradient.<span style="color: #7D9029">x</span> <span style="color: #666666">/</span> gradient.<span style="color: #7D9029">mag</span>, gradient.<span style="color: #7D9029">y</span> <span style="color: #666666">/</span> gradient.<span style="color: #7D9029">mag</span>, gradient.<span style="color: #7D9029">z</span> <span style="color: #666666">/</span> gradient.<span style="color: #7D9029">mag</span>};

        <span style="color: #408080; font-style: italic">// norm light</span>
        <span style="color: #B00040">double</span> lightNorm <span style="color: #666666">=</span> VectorMath.<span style="color: #7D9029">length</span>(lightVector);  <span style="color: #408080; font-style: italic">//Math.sqrt(Math.pow(lightVector[0], 2) + Math.pow(lightVector[1], 2) + Math.pow(lightVector[2], 2));</span>
        <span style="color: #008000; font-weight: bold">if</span>(lightNorm <span style="color: #666666">==</span> <span style="color: #666666">0</span>) <span style="color: #008000; font-weight: bold">return</span> voxel_color;
        <span style="color: #B00040">double</span><span style="color: #666666">[]</span> lightNormVector <span style="color: #666666">=</span> {lightVector<span style="color: #666666">[0]</span> <span style="color: #666666">/</span> lightNorm, lightVector<span style="color: #666666">[1]</span> <span style="color: #666666">/</span> lightNorm, lightVector<span style="color: #666666">[2]</span> <span style="color: #666666">/</span> lightNorm};

        <span style="color: #408080; font-style: italic">// norm ray</span>
        <span style="color: #B00040">double</span> rayNorm <span style="color: #666666">=</span> VectorMath.<span style="color: #7D9029">length</span>(rayVector);  <span style="color: #408080; font-style: italic">//Math.sqrt(Math.pow(rayVector[0], 2) + Math.pow(rayVector[1], 2) + Math.pow(rayVector[2], 2));</span>
        <span style="color: #008000; font-weight: bold">if</span>(rayNorm <span style="color: #666666">==</span> <span style="color: #666666">0</span>) <span style="color: #008000; font-weight: bold">return</span> voxel_color;
        <span style="color: #B00040">double</span><span style="color: #666666">[]</span> rayNormVector <span style="color: #666666">=</span> {rayVector<span style="color: #666666">[0]</span> <span style="color: #666666">/</span> rayNorm, rayVector<span style="color: #666666">[1]</span> <span style="color: #666666">/</span> rayNorm, rayVector<span style="color: #666666">[2]</span> <span style="color: #666666">/</span> rayNorm};

        <span style="color: #408080; font-style: italic">// cos 1</span>
        <span style="color: #B00040">double</span> cos1 <span style="color: #666666">=</span> VectorMath.<span style="color: #7D9029">dotproduct</span>(lightNormVector, gradVec) <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span> <span style="color: #666666">?</span> VectorMath.<span style="color: #7D9029">dotproduct</span>(lightNormVector, gradVec) : <span style="color: #666666">0</span>;

        <span style="color: #408080; font-style: italic">// R</span>
        <span style="color: #B00040">double</span><span style="color: #666666">[]</span> twice_gradVec <span style="color: #666666">=</span> {gradVec<span style="color: #666666">[0]</span> <span style="color: #666666">*</span> <span style="color: #666666">2</span>, gradVec<span style="color: #666666">[1]</span> <span style="color: #666666">*</span> <span style="color: #666666">2</span>, gradVec<span style="color: #666666">[2]</span> <span style="color: #666666">*</span> <span style="color: #666666">2</span>};
        <span style="color: #B00040">double</span> x <span style="color: #666666">=</span> VectorMath.<span style="color: #7D9029">dotproduct</span>(twice_gradVec, lightNormVector);
        <span style="color: #B00040">double</span><span style="color: #666666">[]</span> x_gradVec <span style="color: #666666">=</span> {gradVec<span style="color: #666666">[0]</span> <span style="color: #666666">*</span> x, gradVec<span style="color: #666666">[1]</span> <span style="color: #666666">*</span> x, gradVec<span style="color: #666666">[2]</span> <span style="color: #666666">*</span> x};
        <span style="color: #B00040">double</span><span style="color: #666666">[]</span> R <span style="color: #666666">=</span> {x_gradVec<span style="color: #666666">[0]</span> <span style="color: #666666">-</span> lightNormVector<span style="color: #666666">[0]</span>, x_gradVec<span style="color: #666666">[1]</span> <span style="color: #666666">-</span> lightNormVector<span style="color: #666666">[1]</span>, x_gradVec<span style="color: #666666">[2]</span> <span style="color: #666666">-</span> lightNormVector<span style="color: #666666">[2]</span>};
        <span style="color: #B00040">double</span> cos2 <span style="color: #666666">=</span> VectorMath.<span style="color: #7D9029">dotproduct</span>(rayNormVector, R) <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span> <span style="color: #666666">?</span> VectorMath.<span style="color: #7D9029">dotproduct</span>(rayNormVector, R): <span style="color: #666666">0</span>;

        <span style="color: #B00040">double</span> r <span style="color: #666666">=</span> ka <span style="color: #666666">*</span> voxel_color.<span style="color: #7D9029">r</span> <span style="color: #666666">+</span>
                   kd <span style="color: #666666">*</span> voxel_color.<span style="color: #7D9029">r</span> <span style="color: #666666">*</span> cos1 <span style="color: #666666">+</span>
                   lightProperty_s<span style="color: #666666">[0]</span> <span style="color: #666666">*</span> ks <span style="color: #666666">*</span> Math.<span style="color: #7D9029">pow</span>(cos2, alpha);
        <span style="color: #B00040">double</span> g <span style="color: #666666">=</span> ka <span style="color: #666666">*</span> voxel_color.<span style="color: #7D9029">g</span> <span style="color: #666666">+</span>
                   kd <span style="color: #666666">*</span> voxel_color.<span style="color: #7D9029">g</span> <span style="color: #666666">*</span> cos1 <span style="color: #666666">+</span>
                   lightProperty_s<span style="color: #666666">[1]</span> <span style="color: #666666">*</span> ks <span style="color: #666666">*</span> Math.<span style="color: #7D9029">pow</span>(cos2, alpha);
        <span style="color: #B00040">double</span> b <span style="color: #666666">=</span> ka <span style="color: #666666">*</span> voxel_color.<span style="color: #7D9029">b</span> <span style="color: #666666">+</span>
                   kd <span style="color: #666666">*</span> voxel_color.<span style="color: #7D9029">b</span> <span style="color: #666666">*</span> cos1 <span style="color: #666666">+</span>
                   lightProperty_s<span style="color: #666666">[2]</span> <span style="color: #666666">*</span> ks <span style="color: #666666">*</span> Math.<span style="color: #7D9029">pow</span>(cos2, alpha);
        
        <span style="color: #408080; font-style: italic">// r, g, b should be between 0.0 to 1.0</span>
        <span style="color: #008000; font-weight: bold">if</span> (r <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span>) { r <span style="color: #666666">=</span> <span style="color: #666666">0</span>; }
        <span style="color: #008000; font-weight: bold">if</span> (g <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span>) { g <span style="color: #666666">=</span> <span style="color: #666666">0</span>; }
        <span style="color: #008000; font-weight: bold">if</span> (b <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span>) { b <span style="color: #666666">=</span> <span style="color: #666666">0</span>; }
        <span style="color: #008000; font-weight: bold">if</span> (r <span style="color: #666666">&gt;</span> <span style="color: #666666">1</span>) { r <span style="color: #666666">=</span> <span style="color: #666666">1</span>; }
        <span style="color: #008000; font-weight: bold">if</span> (g <span style="color: #666666">&gt;</span> <span style="color: #666666">1</span>) { g <span style="color: #666666">=</span> <span style="color: #666666">1</span>; }
        <span style="color: #008000; font-weight: bold">if</span> (b <span style="color: #666666">&gt;</span> <span style="color: #666666">1</span>) { b <span style="color: #666666">=</span> <span style="color: #666666">1</span>; }

        color <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> TFColor(r, g, b, voxel_color.<span style="color: #7D9029">a</span>);
        <span style="color: #008000; font-weight: bold">return</span> color;

    }
    
    <span style="color: #408080; font-style: italic">// TODO 8:</span>
    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">double</span> <span style="color: #0000FF">computeOpacity2DTF</span>(<span style="color: #B00040">double</span> material_value, <span style="color: #B00040">double</span> material_r,
            <span style="color: #B00040">double</span> voxelValue, <span style="color: #B00040">double</span> gradMagnitude)
    {
        <span style="color: #B00040">double</span> opacity <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>;

        <span style="color: #408080; font-style: italic">// adding the suggestion announced by Humberto</span>
        <span style="color: #B00040">double</span> radius <span style="color: #666666">=</span> material_r<span style="color: #666666">/</span>gradients.<span style="color: #7D9029">getMaxGradientMagnitude</span>();

        <span style="color: #408080; font-style: italic">// TODO 8: Implement weight based opacity.</span>

        <span style="color: #408080; font-style: italic">// define the upper and lower threshold bounds for material_value</span>

        <span style="color: #B00040">double</span> lowerThresholdForMaterialValue <span style="color: #666666">=</span> voxelValue <span style="color: #666666">-</span> radius <span style="color: #666666">*</span> gradMagnitude;
        <span style="color: #B00040">double</span> upperThresholdForMaterialValue <span style="color: #666666">=</span> voxelValue <span style="color: #666666">+</span> radius <span style="color: #666666">*</span> gradMagnitude;

        <span style="color: #408080; font-style: italic">// compute the value of opacity differently for 3 different inequalities as mentioned in Levoy's paper</span>

        <span style="color: #008000; font-weight: bold">if</span>(material_value <span style="color: #666666">==</span> voxelValue <span style="color: #666666">&amp;&amp;</span> gradMagnitude <span style="color: #666666">==</span> <span style="color: #666666">0</span>)
        {
            opacity <span style="color: #666666">=</span> <span style="color: #666666">1.0</span>;
        }
        <span style="color: #008000; font-weight: bold">else</span> <span style="color: #008000; font-weight: bold">if</span>(gradMagnitude <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span> <span style="color: #666666">&amp;&amp;</span>
		lowerThresholdForMaterialValue <span style="color: #666666">&lt;=</span> material_value <span style="color: #666666">&amp;&amp;</span>
		material_value <span style="color: #666666">&lt;=</span> upperThresholdForMaterialValue)
        {
            opacity <span style="color: #666666">=</span> <span style="color: #666666">1</span> <span style="color: #666666">-</span> (<span style="color: #666666">1/</span>radius) <span style="color: #666666">*</span> Math.<span style="color: #7D9029">abs</span>((voxelValue <span style="color: #666666">-</span> material_value)<span style="color: #666666">/</span>gradMagnitude);
        }
        <span style="color: #008000; font-weight: bold">else</span>
        {
            opacity <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>;
        }

        <span style="color: #008000; font-weight: bold">return</span> opacity;
    }
    
    <span style="color: #408080; font-style: italic">// TODO 5 and 9:</span>
    <span style="color: #B00040">void</span> <span style="color: #0000FF">raycast</span>(<span style="color: #B00040">double</span><span style="color: #666666">[]</span> viewMatrix)
    {
        <span style="color: #408080; font-style: italic">//data allocation</span>
        <span style="color: #B00040">double</span><span style="color: #666666">[]</span> viewVec <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #B00040">double</span><span style="color: #666666">[3]</span>;
        <span style="color: #B00040">double</span><span style="color: #666666">[]</span> uVec <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #B00040">double</span><span style="color: #666666">[3]</span>;
        <span style="color: #B00040">double</span><span style="color: #666666">[]</span> vVec <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #B00040">double</span><span style="color: #666666">[3]</span>;
        <span style="color: #B00040">double</span><span style="color: #666666">[]</span> pixelCoord <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #B00040">double</span><span style="color: #666666">[3]</span>;
        <span style="color: #B00040">double</span><span style="color: #666666">[]</span> entryPoint <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #B00040">double</span><span style="color: #666666">[3]</span>;
        <span style="color: #B00040">double</span><span style="color: #666666">[]</span> exitPoint <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #B00040">double</span><span style="color: #666666">[3]</span>;

        <span style="color: #408080; font-style: italic">// TODO 5: Limited modification is needed</span>
        <span style="color: #408080; font-style: italic">// increment in the pixel domain in pixel units</span>
        <span style="color: #B00040">int</span> increment;
        <span style="color: #408080; font-style: italic">// sample step in voxel units</span>
        <span style="color: #B00040">int</span> sampleStep;

        <span style="color: #408080; font-style: italic">//System.out.println(interactiveMode);</span>
        <span style="color: #008000; font-weight: bold">if</span> (interactiveMode) {
            increment <span style="color: #666666">=</span> <span style="color: #666666">2</span>;
            sampleStep <span style="color: #666666">=</span> <span style="color: #666666">3</span>;
        } <span style="color: #008000; font-weight: bold">else</span> {
            increment <span style="color: #666666">=</span> <span style="color: #666666">1</span>;
            sampleStep <span style="color: #666666">=</span> <span style="color: #666666">1</span>;
        }

        <span style="color: #408080; font-style: italic">// reset the image to black</span>
        resetImage();

        <span style="color: #408080; font-style: italic">// vector uVec and vVec define a plane through the origin,</span>
        <span style="color: #408080; font-style: italic">// perpendicular to the view vector viewVec which is going from the view point towards the object</span>
        <span style="color: #408080; font-style: italic">// uVec contains the up vector of the camera in world coordinates (image vertical)</span>
        <span style="color: #408080; font-style: italic">// vVec contains the horizontal vector in world coordinates (image horizontal)</span>
        VectorMath.<span style="color: #7D9029">setVector</span>(viewVec, viewMatrix<span style="color: #666666">[2]</span>, viewMatrix<span style="color: #666666">[6]</span>, viewMatrix<span style="color: #666666">[10]</span>);
        VectorMath.<span style="color: #7D9029">setVector</span>(uVec, viewMatrix<span style="color: #666666">[0]</span>, viewMatrix<span style="color: #666666">[4]</span>, viewMatrix<span style="color: #666666">[8]</span>);
        VectorMath.<span style="color: #7D9029">setVector</span>(vVec, viewMatrix<span style="color: #666666">[1]</span>, viewMatrix<span style="color: #666666">[5]</span>, viewMatrix<span style="color: #666666">[9]</span>);

        <span style="color: #408080; font-style: italic">// We get the size of the image/texture we will be puting the result of the </span>
        <span style="color: #408080; font-style: italic">// volume rendering operation.</span>
        <span style="color: #B00040">int</span> imageW <span style="color: #666666">=</span> image.<span style="color: #7D9029">getWidth</span>();
        <span style="color: #B00040">int</span> imageH <span style="color: #666666">=</span> image.<span style="color: #7D9029">getHeight</span>();

        <span style="color: #B00040">int</span><span style="color: #666666">[]</span> imageCenter <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #B00040">int</span><span style="color: #666666">[2]</span>;
        <span style="color: #408080; font-style: italic">// Center of the image/texture </span>
        imageCenter<span style="color: #666666">[0]</span> <span style="color: #666666">=</span> imageW <span style="color: #666666">/</span> <span style="color: #666666">2</span>;
        imageCenter<span style="color: #666666">[1]</span> <span style="color: #666666">=</span> imageH <span style="color: #666666">/</span> <span style="color: #666666">2</span>;

        <span style="color: #408080; font-style: italic">//The rayVector is pointing towards the scene</span>
        <span style="color: #B00040">double</span><span style="color: #666666">[]</span> rayVector <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #B00040">double</span><span style="color: #666666">[3]</span>;
        rayVector<span style="color: #666666">[0]</span> <span style="color: #666666">=</span> <span style="color: #666666">-</span>viewVec<span style="color: #666666">[0]</span>;
        rayVector<span style="color: #666666">[1]</span> <span style="color: #666666">=</span> <span style="color: #666666">-</span>viewVec<span style="color: #666666">[1]</span>;
        rayVector<span style="color: #666666">[2]</span> <span style="color: #666666">=</span> <span style="color: #666666">-</span>viewVec<span style="color: #666666">[2]</span>;

        <span style="color: #408080; font-style: italic">// compute the volume center</span>
        <span style="color: #B00040">double</span><span style="color: #666666">[]</span> volumeCenter <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #B00040">double</span><span style="color: #666666">[3]</span>;
        VectorMath.<span style="color: #7D9029">setVector</span>(volumeCenter, volume.<span style="color: #7D9029">getDimX</span>() <span style="color: #666666">/</span> <span style="color: #666666">2</span>, volume.<span style="color: #7D9029">getDimY</span>() <span style="color: #666666">/</span> <span style="color: #666666">2</span>, volume.<span style="color: #7D9029">getDimZ</span>() <span style="color: #666666">/</span> <span style="color: #666666">2</span>);
        
        <span style="color: #408080; font-style: italic">// Vector from entru poin to the planePoint</span>
        <span style="color: #B00040">double</span><span style="color: #666666">[]</span> diffVec <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #B00040">double</span><span style="color: #666666">[3]</span>;
        
        <span style="color: #408080; font-style: italic">// Whether the ray is for upper half-plane</span>
        <span style="color: #B00040">boolean</span> frontBool <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">true</span>;

        <span style="color: #408080; font-style: italic">// ray computation for each pixel</span>
        <span style="color: #008000; font-weight: bold">for</span> (<span style="color: #B00040">int</span> j <span style="color: #666666">=</span> imageCenter<span style="color: #666666">[1]</span> <span style="color: #666666">-</span> imageH <span style="color: #666666">/</span> <span style="color: #666666">2</span>; j <span style="color: #666666">&lt;</span> imageCenter<span style="color: #666666">[1]</span> <span style="color: #666666">+</span> imageH <span style="color: #666666">/</span> <span style="color: #666666">2</span>; j <span style="color: #666666">+=</span> increment) {
            <span style="color: #008000; font-weight: bold">for</span> (<span style="color: #B00040">int</span> i <span style="color: #666666">=</span> imageCenter<span style="color: #666666">[0]</span> <span style="color: #666666">-</span> imageW <span style="color: #666666">/</span> <span style="color: #666666">2</span>; i <span style="color: #666666">&lt;</span> imageCenter<span style="color: #666666">[0]</span> <span style="color: #666666">+</span> imageW <span style="color: #666666">/</span> <span style="color: #666666">2</span>; i <span style="color: #666666">+=</span> increment) {
                <span style="color: #408080; font-style: italic">// compute starting points of rays in a plane shifted backwards to a position behind the data set</span>
                computePixelCoordinatesBehindFloat(pixelCoord, viewVec, uVec, vVec, i, j);
                <span style="color: #408080; font-style: italic">// compute the entry and exit point of the ray</span>
                computeEntryAndExit(pixelCoord, rayVector, entryPoint, exitPoint);

                <span style="color: #408080; font-style: italic">// TODO 9: Implement logic for cutting plane.</span>
                <span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000; font-weight: bold">this</span>.<span style="color: #7D9029">isCuttingPlaneMode</span>()) {
                    <span style="color: #B00040">double</span> dot <span style="color: #666666">=</span> util.<span style="color: #7D9029">VectorMath</span>.<span style="color: #7D9029">dotproduct</span>(util.<span style="color: #7D9029">VectorMath</span>.<span style="color: #7D9029">difference</span>(entryPoint, planePoint, diffVec), planeNorm);
 
                    <span style="color: #008000; font-weight: bold">if</span> (dot <span style="color: #666666">&gt;=</span> <span style="color: #666666">0</span>) {
                        frontBool <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">true</span>;
                    } <span style="color: #008000; font-weight: bold">else</span> {
                        frontBool <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">false</span>;
                    }
                }
                RaycastMode currMode <span style="color: #666666">=</span> getMode(frontBool);

                <span style="color: #008000; font-weight: bold">if</span> ((entryPoint<span style="color: #666666">[0]</span> <span style="color: #666666">&gt;</span> <span style="color: #666666">-1.0</span>) <span style="color: #666666">&amp;&amp;</span> (exitPoint<span style="color: #666666">[0]</span> <span style="color: #666666">&gt;</span> <span style="color: #666666">-1.0</span>)) {
                    <span style="color: #B00040">int</span> val <span style="color: #666666">=</span> <span style="color: #666666">0</span>;
                    <span style="color: #008000; font-weight: bold">switch</span> (currMode) {
                        <span style="color: #008000; font-weight: bold">case</span> COMPOSITING:
                        <span style="color: #008000; font-weight: bold">case</span> TRANSFER2D:
                            val <span style="color: #666666">=</span> traceRayComposite(entryPoint, exitPoint, rayVector, sampleStep, frontBool);
                            <span style="color: #008000; font-weight: bold">break</span>;
                        <span style="color: #008000; font-weight: bold">case</span> MIP:
                            val <span style="color: #666666">=</span> traceRayMIP(entryPoint, exitPoint, rayVector, sampleStep);
                            <span style="color: #008000; font-weight: bold">break</span>;
                        <span style="color: #008000; font-weight: bold">case</span> ISO_SURFACE:
                            val <span style="color: #666666">=</span> traceRayIso(entryPoint, exitPoint, rayVector, sampleStep, frontBool);
                            <span style="color: #008000; font-weight: bold">break</span>;
                    }
                    <span style="color: #008000; font-weight: bold">for</span> (<span style="color: #B00040">int</span> ii <span style="color: #666666">=</span> i; ii <span style="color: #666666">&lt;</span> i <span style="color: #666666">+</span> increment; ii<span style="color: #666666">++</span>) {
                        <span style="color: #008000; font-weight: bold">for</span> (<span style="color: #B00040">int</span> jj <span style="color: #666666">=</span> j; jj <span style="color: #666666">&lt;</span> j <span style="color: #666666">+</span> increment; jj<span style="color: #666666">++</span>) {
                            image.<span style="color: #7D9029">setRGB</span>(ii, jj, val);
                        }
                    }
                }

            }
        }
    }
    
    <span style="color: #408080; font-style: italic">// Utility functions for cutting plane</span>
    <span style="color: #008000; font-weight: bold">public</span> TFColor <span style="color: #0000FF">getIsoColor</span>(<span style="color: #B00040">boolean</span> frontBool) {
        <span style="color: #008000; font-weight: bold">if</span> (frontBool) {
            <span style="color: #008000; font-weight: bold">return</span> isoColorFront;
        } <span style="color: #008000; font-weight: bold">else</span> {
            <span style="color: #008000; font-weight: bold">return</span> isoColorBack;
        }
    }

    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">float</span> <span style="color: #0000FF">getIsoValue</span>(<span style="color: #B00040">boolean</span> frontBool) {
        <span style="color: #008000; font-weight: bold">if</span> (frontBool) {
            <span style="color: #008000; font-weight: bold">return</span> isoValueFront;
        } <span style="color: #008000; font-weight: bold">else</span> {
            <span style="color: #008000; font-weight: bold">return</span> isoValueBack;
        }
    }

    <span style="color: #008000; font-weight: bold">public</span> RaycastMode <span style="color: #0000FF">getMode</span>(<span style="color: #B00040">boolean</span> frontBool) {
        <span style="color: #008000; font-weight: bold">if</span> (frontBool) {
            <span style="color: #008000; font-weight: bold">return</span> modeFront;
        } <span style="color: #008000; font-weight: bold">else</span> {
            <span style="color: #008000; font-weight: bold">return</span> modeBack;
        }
    }

    <span style="color: #008000; font-weight: bold">public</span> TransferFunction <span style="color: #0000FF">getTFunc</span>(<span style="color: #B00040">boolean</span> frontBool) {
        <span style="color: #008000; font-weight: bold">if</span> (frontBool) {
            <span style="color: #008000; font-weight: bold">return</span> tFuncFront;
        } <span style="color: #008000; font-weight: bold">else</span> {
            <span style="color: #008000; font-weight: bold">return</span> tFuncBack;
        }
    }

    <span style="color: #008000; font-weight: bold">public</span> TransferFunction2D <span style="color: #0000FF">getTFunc2D</span>(<span style="color: #B00040">boolean</span> frontBool) {
        <span style="color: #008000; font-weight: bold">if</span> (frontBool) {
            <span style="color: #008000; font-weight: bold">return</span> tFunc2DFront;
        } <span style="color: #008000; font-weight: bold">else</span> {
            <span style="color: #008000; font-weight: bold">return</span> tFunc2DBack;
        }
    }
    
}
</pre></div>
